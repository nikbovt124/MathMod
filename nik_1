# Бовтута Николай – для региона 75 рассчитайте урожайность пшеницы в 2010 году, взяв для рассчета средние суммы активных температур за предыдущие 15 лет, с 23 ближайших метеостанций
# установить.пакеты ("tidyverse")
# установить.пакеты ("rnoaa")
# установить.пакеты ("lubridate")
библиотека( tidyverse)
библиотека( rnoaa)
библиотека (lubridate)
###Создадим векторы с данными для расчета: Р°:
afi = c(0.00,0.00,0.00,32.11, 26.31,25.64,23.20,18.73,16.30,13.83,0.00,0.00) #константа
bfi = c(0.00, 0.00, 0.00, 11.30, 9.26, 9.03,8.16, 6.59, 5.73, 4.87, 0.00, 0.00) #константа
dfi = c(0.00,0.00, 0.00, 0.33, 1.00, 1.00, 1.00, 0.32, 0.00, 0.00, 0.00, 0.00) #отношение числа дней i-го месяца, входящих в период вегетации культуры, к общему числу дней в месяце
Kf = 300 # Коэффициент использования ФАР
Qj = 1600 # калорийность урожая культуры
Lj = 2.2 # сумма частей основной и побочной продукции
Ej = 25 # стандартная влажность культуры 
#скачиваем станции 
#station_data = ghcnd_stations()
station_data  = читать.csv ("station_data.csv")
#после получения всписка всех станций, получите список станций ближайших к точке в регионе(я брал близкой к столице),создав таблицу с именем региона и координатами
Chita  =  данные.рамка (id  =  " Chita ", широта  =  52.0154 , долгота  =  113.3003)
Chita
#найдем станции, соответствующие критериям
Chita _around  = meteo_nearby_stations( lat_lon_df  =  Chita, station_data  =  station_data,
                                          предел  =  23, var  = c ("PRCP", " TAVG "),
                                          year_min  =  1995, year_max  =  2010)
#В итоге получаем список(таблицу) с идентификаторами метиостанций по удаленности их от Chita
Chita _район
# объединим данные, создав цикл для всех метеостанций, выбрав нужное время
all_ Chita _data = tibble() 
для ( v  в  1: 23) 
{ 
  Chita _id  =  Chita _around [["Chita " ]] [["id" ]][ v] 
  # 
  data = meteo_tidy_ghcnd(stationid = Chita _id, 
                          var="TAVG", 
                          date_min="1995-01-01", 
                          date_max="2010-12-31") 
  all_ Chita _data  = bind_rows( all_ Chita _data, данные) 
} 
### произведем обработку полученных данных 
#Добавим для наших данных колонки year, month для группировки
clean_data  =  all_ Chita _data %>>% 
 мутировать( год  = год( дата ), месяц  = месяц (дата )) %>>% 
  #И сгрупируем с учетом id наших метеостанций
 group_by_ (год, месяц, id) %>>% 
  # суммирования с учетом id метеостанций
 summary( tavg  = сумма (tavg [ tavg>> 5], na.rm = TRUE ) / 15) %>>% 
  # нахождения средних месячных активных температур, сгрупировав данные: 
 group_by (месяц ) %>>% 
 summary( s  = mean (tavg, na.rm  =  TRUE)) %>>% 
  # создадим колонки для расчета: 
 мутация (a  =  afi , b  =  bfi , d  =  dfi ) %>>% 
  # и рассчитаем урожайность для каждого месяца: 
 мутировать ( fert  = ((a  +  b  *  s ) *  d  *  Kf ) / (Qj  *  Lj  * (100-Ej)) ) 
# сумма урожайностей равна: 
Yield  = сумма (clean_data $ fert ); Yield
